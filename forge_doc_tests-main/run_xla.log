ðŸ§ª Install and test the pjrt-plugin-tt package.
Requirement already satisfied: pip in /usr/local/lib/python3.10/dist-packages (25.2)
WARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager, possibly rendering your system unusable. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv. Use the --root-user-action option if you know what you are doing and want to suppress this warning.
Looking in indexes: https://pypi.org/simple, https://pypi.eng.aws.tenstorrent.com/
Collecting pjrt-plugin-tt
  Downloading https://pypi.eng.aws.tenstorrent.com/pjrt-plugin-tt/pjrt_plugin_tt-0.3.0-py3-none-linux_x86_64.whl (187.5 MB)
     â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 187.5/187.5 MB 123.0 MB/s  0:00:01
Collecting jax>=0.6.0 (from pjrt-plugin-tt)
  Downloading jax-0.6.2-py3-none-any.whl.metadata (13 kB)
Collecting jaxlib>=0.6.0 (from pjrt-plugin-tt)
  Downloading jaxlib-0.6.2-cp310-cp310-manylinux2014_x86_64.whl.metadata (1.3 kB)
Collecting ml_dtypes>=0.5.0 (from jax>=0.6.0->pjrt-plugin-tt)
  Downloading ml_dtypes-0.5.3-cp310-cp310-manylinux_2_27_x86_64.manylinux_2_28_x86_64.whl.metadata (8.9 kB)
Collecting numpy>=1.26 (from jax>=0.6.0->pjrt-plugin-tt)
  Downloading numpy-2.2.6-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (62 kB)
Collecting opt_einsum (from jax>=0.6.0->pjrt-plugin-tt)
  Downloading opt_einsum-3.4.0-py3-none-any.whl.metadata (6.3 kB)
Collecting scipy>=1.12 (from jax>=0.6.0->pjrt-plugin-tt)
  Downloading scipy-1.15.3-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (61 kB)
Downloading jax-0.6.2-py3-none-any.whl (2.7 MB)
   â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 2.7/2.7 MB 84.5 MB/s  0:00:00
Downloading jaxlib-0.6.2-cp310-cp310-manylinux2014_x86_64.whl (89.9 MB)
   â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 89.9/89.9 MB 123.2 MB/s  0:00:00
Downloading ml_dtypes-0.5.3-cp310-cp310-manylinux_2_27_x86_64.manylinux_2_28_x86_64.whl (4.9 MB)
   â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 4.9/4.9 MB 73.0 MB/s  0:00:00
Downloading numpy-2.2.6-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (16.8 MB)
   â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 16.8/16.8 MB 70.6 MB/s  0:00:00
Downloading scipy-1.15.3-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (37.7 MB)
   â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 37.7/37.7 MB 77.4 MB/s  0:00:00
Downloading opt_einsum-3.4.0-py3-none-any.whl (71 kB)
Installing collected packages: opt_einsum, numpy, scipy, ml_dtypes, jaxlib, jax, pjrt-plugin-tt

Successfully installed jax-0.6.2 jaxlib-0.6.2 ml_dtypes-0.5.3 numpy-2.2.6 opt_einsum-3.4.0 pjrt-plugin-tt-0.3.0 scipy-1.15.3
WARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager, possibly rendering your system unusable. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv. Use the --root-user-action option if you know what you are doing and want to suppress this warning.
ðŸ“¦ Installing dependencies for the demo.
Collecting flax
  Downloading flax-0.10.7-py3-none-any.whl.metadata (11 kB)
Collecting transformers
  Downloading transformers-4.56.2-py3-none-any.whl.metadata (40 kB)
Requirement already satisfied: jax>=0.6.0 in /usr/local/lib/python3.10/dist-packages (from flax) (0.6.2)
Collecting msgpack (from flax)
  Downloading msgpack-1.1.1-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (8.4 kB)
Collecting optax (from flax)
  Downloading optax-0.2.6-py3-none-any.whl.metadata (7.6 kB)
Collecting orbax-checkpoint (from flax)
  Downloading orbax_checkpoint-0.11.25-py3-none-any.whl.metadata (2.3 kB)
Collecting tensorstore (from flax)
  Downloading tensorstore-0.1.77-cp310-cp310-manylinux_2_27_x86_64.manylinux_2_28_x86_64.whl.metadata (21 kB)
Collecting rich>=11.1 (from flax)
  Downloading rich-14.1.0-py3-none-any.whl.metadata (18 kB)
Collecting typing_extensions>=4.2 (from flax)
  Downloading typing_extensions-4.15.0-py3-none-any.whl.metadata (3.3 kB)
Requirement already satisfied: PyYAML>=5.4.1 in /usr/lib/python3/dist-packages (from flax) (5.4.1)
Collecting treescope>=0.1.7 (from flax)
  Downloading treescope-0.1.10-py3-none-any.whl.metadata (6.6 kB)
Collecting filelock (from transformers)
  Downloading filelock-3.19.1-py3-none-any.whl.metadata (2.1 kB)
Collecting huggingface-hub<1.0,>=0.34.0 (from transformers)
  Downloading huggingface_hub-0.35.1-py3-none-any.whl.metadata (14 kB)
Requirement already satisfied: numpy>=1.17 in /usr/local/lib/python3.10/dist-packages (from transformers) (2.2.6)
Collecting packaging>=20.0 (from transformers)
  Downloading packaging-25.0-py3-none-any.whl.metadata (3.3 kB)
Collecting regex!=2019.12.17 (from transformers)
  Downloading regex-2025.9.18-cp310-cp310-manylinux2014_x86_64.manylinux_2_17_x86_64.manylinux_2_28_x86_64.whl.metadata (40 kB)
Collecting requests (from transformers)
  Downloading requests-2.32.5-py3-none-any.whl.metadata (4.9 kB)
Collecting tokenizers<=0.23.0,>=0.22.0 (from transformers)
  Downloading tokenizers-0.22.1-cp39-abi3-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (6.8 kB)
Collecting safetensors>=0.4.3 (from transformers)
  Downloading safetensors-0.6.2-cp38-abi3-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (4.1 kB)
Collecting tqdm>=4.27 (from transformers)
  Downloading tqdm-4.67.1-py3-none-any.whl.metadata (57 kB)
Collecting fsspec>=2023.5.0 (from huggingface-hub<1.0,>=0.34.0->transformers)
  Downloading fsspec-2025.9.0-py3-none-any.whl.metadata (10 kB)
Collecting hf-xet<2.0.0,>=1.1.3 (from huggingface-hub<1.0,>=0.34.0->transformers)
  Downloading hf_xet-1.1.10-cp37-abi3-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (4.7 kB)
Requirement already satisfied: jaxlib<=0.6.2,>=0.6.2 in /usr/local/lib/python3.10/dist-packages (from jax>=0.6.0->flax) (0.6.2)
Requirement already satisfied: ml_dtypes>=0.5.0 in /usr/local/lib/python3.10/dist-packages (from jax>=0.6.0->flax) (0.5.3)
Requirement already satisfied: opt_einsum in /usr/local/lib/python3.10/dist-packages (from jax>=0.6.0->flax) (3.4.0)
Requirement already satisfied: scipy>=1.12 in /usr/local/lib/python3.10/dist-packages (from jax>=0.6.0->flax) (1.15.3)
Collecting markdown-it-py>=2.2.0 (from rich>=11.1->flax)
  Downloading markdown_it_py-4.0.0-py3-none-any.whl.metadata (7.3 kB)
Collecting pygments<3.0.0,>=2.13.0 (from rich>=11.1->flax)
  Downloading pygments-2.19.2-py3-none-any.whl.metadata (2.5 kB)
Collecting mdurl~=0.1 (from markdown-it-py>=2.2.0->rich>=11.1->flax)
  Downloading mdurl-0.1.2-py3-none-any.whl.metadata (1.6 kB)
Collecting absl-py>=0.7.1 (from optax->flax)
  Downloading absl_py-2.3.1-py3-none-any.whl.metadata (3.3 kB)
Collecting chex>=0.1.87 (from optax->flax)
  Downloading chex-0.1.90-py3-none-any.whl.metadata (18 kB)
Collecting toolz>=0.9.0 (from chex>=0.1.87->optax->flax)
  Downloading toolz-1.0.0-py3-none-any.whl.metadata (5.1 kB)
Collecting etils[epath,epy] (from orbax-checkpoint->flax)
  Downloading etils-1.13.0-py3-none-any.whl.metadata (6.5 kB)
Collecting nest_asyncio (from orbax-checkpoint->flax)
  Downloading nest_asyncio-1.6.0-py3-none-any.whl.metadata (2.8 kB)
Collecting aiofiles (from orbax-checkpoint->flax)
  Downloading aiofiles-24.1.0-py3-none-any.whl.metadata (10 kB)
Collecting protobuf (from orbax-checkpoint->flax)
  Downloading protobuf-6.32.1-cp39-abi3-manylinux2014_x86_64.whl.metadata (593 bytes)
Collecting humanize (from orbax-checkpoint->flax)
  Downloading humanize-4.13.0-py3-none-any.whl.metadata (7.8 kB)
Collecting simplejson>=3.16.0 (from orbax-checkpoint->flax)
  Downloading simplejson-3.20.1-cp310-cp310-manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (3.2 kB)
Collecting importlib_resources (from etils[epath,epy]->orbax-checkpoint->flax)
  Downloading importlib_resources-6.5.2-py3-none-any.whl.metadata (3.9 kB)
Requirement already satisfied: zipp in /usr/lib/python3/dist-packages (from etils[epath,epy]->orbax-checkpoint->flax) (1.0.0)
Collecting charset_normalizer<4,>=2 (from requests->transformers)
  Downloading charset_normalizer-3.4.3-cp310-cp310-manylinux2014_x86_64.manylinux_2_17_x86_64.manylinux_2_28_x86_64.whl.metadata (36 kB)
Collecting idna<4,>=2.5 (from requests->transformers)
  Downloading idna-3.10-py3-none-any.whl.metadata (10 kB)
Collecting urllib3<3,>=1.21.1 (from requests->transformers)
  Downloading urllib3-2.5.0-py3-none-any.whl.metadata (6.5 kB)
Collecting certifi>=2017.4.17 (from requests->transformers)
  Downloading certifi-2025.8.3-py3-none-any.whl.metadata (2.4 kB)
Downloading flax-0.10.7-py3-none-any.whl (456 kB)
Downloading transformers-4.56.2-py3-none-any.whl (11.6 MB)
   â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 11.6/11.6 MB 119.8 MB/s  0:00:00
Downloading huggingface_hub-0.35.1-py3-none-any.whl (563 kB)
   â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 563.3/563.3 kB 52.5 MB/s  0:00:00
Downloading hf_xet-1.1.10-cp37-abi3-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (3.2 MB)
   â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 3.2/3.2 MB 124.5 MB/s  0:00:00
Downloading tokenizers-0.22.1-cp39-abi3-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (3.3 MB)
   â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 3.3/3.3 MB 108.4 MB/s  0:00:00
Downloading fsspec-2025.9.0-py3-none-any.whl (199 kB)
Downloading packaging-25.0-py3-none-any.whl (66 kB)
Downloading regex-2025.9.18-cp310-cp310-manylinux2014_x86_64.manylinux_2_17_x86_64.manylinux_2_28_x86_64.whl (789 kB)
   â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 789.9/789.9 kB 65.9 MB/s  0:00:00
Downloading rich-14.1.0-py3-none-any.whl (243 kB)
Downloading pygments-2.19.2-py3-none-any.whl (1.2 MB)
   â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 1.2/1.2 MB 94.1 MB/s  0:00:00
Downloading markdown_it_py-4.0.0-py3-none-any.whl (87 kB)
Downloading mdurl-0.1.2-py3-none-any.whl (10.0 kB)
Downloading safetensors-0.6.2-cp38-abi3-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (485 kB)
Downloading tqdm-4.67.1-py3-none-any.whl (78 kB)
Downloading treescope-0.1.10-py3-none-any.whl (182 kB)
Downloading typing_extensions-4.15.0-py3-none-any.whl (44 kB)
Downloading filelock-3.19.1-py3-none-any.whl (15 kB)
Downloading msgpack-1.1.1-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (408 kB)
Downloading optax-0.2.6-py3-none-any.whl (367 kB)
Downloading absl_py-2.3.1-py3-none-any.whl (135 kB)
Downloading chex-0.1.90-py3-none-any.whl (101 kB)
Downloading toolz-1.0.0-py3-none-any.whl (56 kB)
Downloading orbax_checkpoint-0.11.25-py3-none-any.whl (563 kB)
   â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 563.1/563.1 kB 56.0 MB/s  0:00:00
Downloading simplejson-3.20.1-cp310-cp310-manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_17_x86_64.manylinux2014_x86_64.whl (138 kB)
Downloading tensorstore-0.1.77-cp310-cp310-manylinux_2_27_x86_64.manylinux_2_28_x86_64.whl (19.5 MB)
   â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 19.5/19.5 MB 115.3 MB/s  0:00:00
Downloading aiofiles-24.1.0-py3-none-any.whl (15 kB)
Downloading etils-1.13.0-py3-none-any.whl (170 kB)
Downloading humanize-4.13.0-py3-none-any.whl (128 kB)
Downloading importlib_resources-6.5.2-py3-none-any.whl (37 kB)
Downloading nest_asyncio-1.6.0-py3-none-any.whl (5.2 kB)
Downloading protobuf-6.32.1-cp39-abi3-manylinux2014_x86_64.whl (322 kB)
Downloading requests-2.32.5-py3-none-any.whl (64 kB)
Downloading charset_normalizer-3.4.3-cp310-cp310-manylinux2014_x86_64.manylinux_2_17_x86_64.manylinux_2_28_x86_64.whl (152 kB)
Downloading idna-3.10-py3-none-any.whl (70 kB)
Downloading urllib3-2.5.0-py3-none-any.whl (129 kB)
Downloading certifi-2025.8.3-py3-none-any.whl (161 kB)
Installing collected packages: urllib3, typing_extensions, treescope, tqdm, toolz, simplejson, safetensors, regex, pygments, protobuf, packaging, nest_asyncio, msgpack, mdurl, importlib_resources, idna, humanize, hf-xet, fsspec, filelock, etils, charset_normalizer, certifi, aiofiles, absl-py, tensorstore, requests, markdown-it-py, rich, huggingface-hub, tokenizers, orbax-checkpoint, chex, transformers, optax, flax
  Attempting uninstall: pygments
    Found existing installation: Pygments 2.11.2
    Uninstalling Pygments-2.11.2:
      Successfully uninstalled Pygments-2.11.2

Successfully installed absl-py-2.3.1 aiofiles-24.1.0 certifi-2025.8.3 charset_normalizer-3.4.3 chex-0.1.90 etils-1.13.0 filelock-3.19.1 flax-0.10.7 fsspec-2025.9.0 hf-xet-1.1.10 huggingface-hub-0.35.1 humanize-4.13.0 idna-3.10 importlib_resources-6.5.2 markdown-it-py-4.0.0 mdurl-0.1.2 msgpack-1.1.1 nest_asyncio-1.6.0 optax-0.2.6 orbax-checkpoint-0.11.25 packaging-25.0 protobuf-6.32.1 pygments-2.19.2 regex-2025.9.18 requests-2.32.5 rich-14.1.0 safetensors-0.6.2 simplejson-3.20.1 tensorstore-0.1.77 tokenizers-0.22.1 toolz-1.0.0 tqdm-4.67.1 transformers-4.56.2 treescope-0.1.10 typing_extensions-4.15.0 urllib3-2.5.0
WARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager, possibly rendering your system unusable. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv. Use the --root-user-action option if you know what you are doing and want to suppress this warning.
ðŸš€ Running the demo...
WARNING:2025-09-24 21:14:48,223:jax._src.xla_bridge:825: Platform 'tt' is experimental and not all JAX functionality may be correctly supported!
2025-09-24 21:14:48.236 | info     |          Device | Opening user mode device driver (tt_cluster.cpp:194)
2025-09-24 21:14:48.270 | info     |   SiliconDriver | Harvesting mask for chip 0 is 0x80 (NOC0: 0x80, simulated harvesting mask: 0x0). (cluster.cpp:341)
2025-09-24 21:14:48.307 | warning  |   SiliconDriver | init_detect_tt_device_numanodes(): Could not determine NumaNodeSet for TT device (physical_device_id: 0 pci_bus_id: 0000:05:00.0) (cpuset_lib.cpp:578)
2025-09-24 21:14:48.307 | warning  |   SiliconDriver | Could not find NumaNodeSet for TT Device (physical_device_id: 0 pci_bus_id: 0000:05:00.0) (cpuset_lib.cpp:182)
2025-09-24 21:14:48.308 | warning  |   SiliconDriver | bind_area_memory_nodeset(): Unable to determine TT Device to NumaNode mapping for physical_device_id: 0. Skipping membind. (cpuset_lib.cpp:463)
2025-09-24 21:14:48.308 | warning  |   SiliconDriver | ---- ttSiliconDevice::init_hugepage: bind_area_to_memory_nodeset() failed (physical_device_id: 0 ch: 0). Hugepage allocation is not on NumaNode matching TT Device. Side-Effect is decreased Device->Host perf (Issue #893). (sysmem_manager.cpp:214)
2025-09-24 21:14:48.308 | info     |   SiliconDriver | Opening local chip ids/pci ids: {0}/[0] and remote chip ids {} (cluster.cpp:202)
2025-09-24 21:14:48.309 | info     |   SiliconDriver | All devices in cluster running firmware version: 18.10.0 (cluster.cpp:183)
2025-09-24 21:14:48.309 | info     |   SiliconDriver | IOMMU: disabled (cluster.cpp:157)
2025-09-24 21:14:48.309 | info     |   SiliconDriver | KMD version: 2.4.0 (cluster.cpp:160)
2025-09-24 21:14:48.309 | info     |   SiliconDriver | Software version 6.0.0, Ethernet FW version 7.0.0 (Device 0) (cluster.cpp:981)
2025-09-24 21:14:48.312 | info     |   SiliconDriver | Pinning pages for Hugepage: virtual address 0x7f0500000000 and size 0x40000000 pinned to physical address 0x200000000 (pci_device.cpp:543)
2025-09-24 21:14:48.344 | info     |    BuildKernels | Skipping deleting built cache (build.cpp:110)
TensorFlow and JAX classes are deprecated and will be removed in Transformers v5. We recommend migrating to PyTorch classes or pinning your version of Transformers.
2025-09-24 21:15:04.815 | warning  |          Always | Closing and re-initializing MetalContext with same parameters due to force_reinit flag. (metal_context.cpp:81)
2025-09-24 21:15:04.855 | info     |           Metal | Disabling and clearing program cache on MeshDevice 1 (mesh_device.cpp:636)
Prompt: The capital of France is
Next token: ' the' (id: 262)
Probability: 0.0878

Rank  Token ID   Token           Probability
---------------------------------------------
1     262        ' the'          0.0878    
2     257        ' a'            0.0460    
3     783        ' now'          0.0429    
4     6342       ' Paris'        0.0359    
5     4881       ' France'       0.0351    
6     287        ' in'           0.0268    
7     635        ' also'         0.0248    
8     407        ' not'          0.0229    
9     1363       ' home'         0.0211    
10    991        ' still'        0.0153    
11    5140       ' located'      0.0152    
12    739        ' under'        0.0135    
13    319        ' on'           0.0129    
14    530        ' one'          0.0113    
15    1900       ' known'        0.0084    
16    379        ' at'           0.0084    
17    281        ' an'           0.0083    
18    852        ' being'        0.0072    
19    1541       ' already'      0.0066    
20    284        ' to'           0.0048    
2025-09-24 21:16:13.385 | info     |          Device | Closing user mode device drivers (tt_cluster.cpp:385)
âœ… Demo completed.
